area,canonical_impl,file,notes,replaced_examples
cache_keys,ListCacheKey & entity_id_key,src/utils/cache_key.rs,Unified list/entity cache key construction,build_posts_cache_key|build_users_cache_key
api_delete_response,delete_with & ok_message,src/utils/response_ext.rs,Standard JSON success/delete responses,handlers/posts.rs::delete_post|handlers/users.rs::delete_user|handlers/api_keys.rs::revoke_api_key (was raw Json/status)
create_entity,create_entity,src/utils/crud.rs,Generic create (201 + ApiOk) with optional hook,handlers/posts.rs::create_post|handlers/admin.rs::create_post (was inline DB + mapping)
update_entity,update_entity,src/utils/crud.rs,Generic update with optional post-hook (search indexing),handlers/posts.rs::update_post|handlers/users.rs::update_user (was direct calls + indexing)
api_keys_standardization,ApiOk + delete_with patterns,src/handlers/api_keys.rs,Normalized create/list/revoke response shapes,create_api_key/list_api_keys/revoke_api_key (was mixed tuple + raw Json)
pagination_core,fetch_paginated_cached,src/utils/paginate.rs,Base cached pagination (unchanged this pass),used internally by higher helpers
pagination_mapped,fetch_paginated_cached_mapped,src/utils/paginate.rs,Eliminated per-handler map boilerplate,handlers/posts.rs::paginate_posts|handlers/users.rs::paginate_users (replaced fetch_paginated_cached_with_filters + map loop)
admin_post_unify,create_entity + delete_with,src/handlers/admin.rs,Admin create/delete aligned with public patterns,admin::create_post|admin::delete_post (was manual + 204)
auth_tokens_unify,AuthTokens struct + From conversions,src/utils/auth_response.rs,Central token shaping used by auth handlers,handlers/auth.rs::refresh_token (manual struct => From impl)
auth_success_response_unify,AuthSuccessResponse unified schema,src/utils/auth_response.rs,Login/Register now return unified tokens container + flattened fields,handlers/auth.rs::login|handlers/auth.rs::register (was LoginResponse)
search_index_dispatcher,search_index_entity_safe + SearchEntity,src/app.rs|src/utils/search_index.rs,Generic search indexing dispatcher removing per-entity closures,handlers/posts.rs::create_post|handlers/posts.rs::update_post|handlers/users.rs::update_user (was separate *_safe calls)
cache_key_wrapper_removal,Removed deprecated build_*_cache_key helpers,src/handlers/posts.rs|src/handlers/users.rs,Fully eliminated legacy wrappers (direct ListCacheKey usage),n/a
dto_from_model_macro,dto_from_model!,src/utils/dto.rs,Generates &T and owned conversions removing repeated impl blocks,handlers/posts.rs::PostDto from Post|utils/common_types.rs::UserInfo from User
auth_migration_docs,Auth response migration guide,docs/AUTH_MIGRATION_V2.md,Explains transition to AuthSuccessResponse,handlers/auth.rs (login/register) unified schema
auth_refresh_unify,Refresh endpoint unified to AuthSuccessResponse,src/handlers/auth.rs|src/utils/auth_response.rs|src/auth/mod.rs,Extends refresh output to full unified schema,handlers/auth.rs::refresh_token
auth_refresh_biscuit_rotation,Refresh issues new biscuit access token,src/auth/mod.rs|tests/biscuit_token_flow_tests.rs,Backward compatibility: biscuit_token now populated on refresh,auth::refresh_access_token
auth_refresh_response_removal,Removed legacy RefreshResponse,src/auth/mod.rs|src/handlers/auth.rs|docs/AUTH_MIGRATION_V2.md,Refresh now directly builds AuthSuccessResponse tokens tuple,refresh_access_token handler
admin_token_legacy_removal,Removed admin_auth_layer & admin token utils,src/middleware/mod.rs|<deleted>/src/middleware/admin_auth.rs|<deleted>/src/utils/auth_utils.rs,Use Biscuit + role/permission checks instead,check_admin_token|get_admin_token|admin_auth_layer
posts_cache_key_fn_removal,Removed deprecated build_posts_cache_key,src/handlers/posts.rs,Function no longer needed after ListCacheKey adoption,build_posts_cache_key
auth_flat_fields_deprecation,Deprecated flattened token fields in AuthSuccessResponse,src/utils/auth_response.rs,Guides clients to use nested tokens.*,access_token|refresh_token|biscuit_token|expires_in|session_id|token
legacy_auth_flat_feature_gating,LoginResponse behind feature gate,src/handlers/auth.rs|src/openapi.rs,Feature legacy-auth-flat controls legacy schema exposure,LoginResponse schema unconditional inclusion
refresh_tamper_negative_tests,Tamper & garbage refresh rejection,tests/biscuit_refresh_tamper_tests.rs,Ensures signature and structural validation for refresh tokens,tampered_refresh_token_rejected|random_garbage_token_rejected
refresh_session_missing_negative_test,Session missing refresh rejection,tests/biscuit_refresh_session_missing_tests.rs,Ensures refresh requires existing active session,refresh_fails_when_session_missing
phase4_plan_doc,Phase 4 removal plan documented,docs/AUTH_MIGRATION_V2.md,Adds 3.0.0 removal checklist & risk table,AuthSuccessResponse flattened fields future removal
phase4_public_notice,Phase 4 public notices added,CHANGELOG.md|README.md,Advance breaking change warning inserted,legacy-auth-flat feature & flattened fields
phase4_issue_template,Phase 4 removal issue template,.github/ISSUE_TEMPLATE/phase4_removal_checklist.md,Operationalizes removal checklist,deprecation removal workflow
deprecated_field_scan_job,CI job scans for flattened auth field usage,.github/workflows/ci.yml,Non-blocking informational scan prior to 3.0.0,grep -R tokens.* fallback
auth_flat_deprecation_note_versioned,Add 3.0.0 removal notice to deprecated fields,src/utils/auth_response.rs,Clarifies timeline in attribute notes,AuthSuccessResponse fields
openapi_phase4_comment,Add Phase 4 removal comment for LoginResponse schema,src/openapi.rs,Signals planned elimination of conditional legacy schema,in-file comment
openapi_snapshot_guard,Add OpenAPI schema snapshot test,tests/openapi_snapshot.rs,Detects unintended schema regressions & legacy schema leakage,insta snapshot
openapi_auth_success_schema_guard,Focused AuthSuccessResponse schema snapshot,tests/openapi_auth_success_snapshot.rs,Guards structure & deprecated fields until Phase 4,auth_success_schema only
auth_success_flatten_consistency_guard,Flattened auth fields consistency test,tests/auth_success_flatten_consistency.rs,Ensures deprecated fields mirror tokens.* until removal,assert equality
verify_jwt_feature_gate,Gate deprecated verify_jwt by legacy-auth-flat,src/auth/mod.rs,Prepares removal of old JWT-style accessor by Phase 4,#[cfg(feature)] around verify_jwt
legacy_admin_token_feature_gate,Gate legacy admin token utils & middleware,Cargo.toml|src/utils/auth_utils.rs|src/middleware/admin_auth.rs,Optional retention of ADMIN_TOKEN path until 3.0.0,check_admin_token|get_admin_token|admin_auth_layer gated
